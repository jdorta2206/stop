
{
  "entities": {
    "User": {
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Global Stop game.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the user (Firebase Auth UID)." },
        "displayName": { "type": "string", "description": "The user's public display name." },
        "photoURL": { "type": "string", "description": "URL to the user's profile picture.", "format": "uri" },
        "email": { "type": "string", "description": "The user's email address.", "format": "email" }
      },
      "required": ["id", "displayName"]
    },
    "Player": {
        "title": "Player",
        "type": "object",
        "description": "Represents a player within a game room.",
        "properties": {
            "id": { "type": "string", "description": "The player's unique ID (matches Firebase Auth UID)." },
            "name": { "type": "string", "description": "The player's display name." },
            "avatar": { "type": "string", "description": "URL to the player's avatar." },
            "isReady": { "type": "boolean", "description": "Indicates if the player is ready to start." },
            "status": { "type": "string", "enum": ["online", "away", "offline"], "description": "Player's connection status." },
            "joinedAt": { "type": "string", "format": "date-time", "description": "Timestamp when the player joined." },
            "isHost": { "type": "boolean", "description": "Indicates if the player is the host of the room." }
        },
        "required": ["id", "name", "isReady", "status", "isHost"]
    },
    "Room": {
        "title": "Room",
        "type": "object",
        "description": "Represents a multiplayer game room.",
        "properties": {
            "hostId": { "type": "string", "description": "The UID of the user hosting the room." },
            "status": { "type": "string", "enum": ["waiting", "playing", "finished"], "description": "The current status of the room." },
            "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp when the room was created." },
            "settings": {
                "type": "object",
                "properties": {
                    "maxPlayers": { "type": "number" },
                    "roundDuration": { "type": "number" },
                    "isPrivate": { "type": "boolean" },
                    "language": { "type": "string", "enum": ["es", "en", "fr", "pt"] }
                }
            },
            "players": {
                "type": "object",
                "additionalProperties": { "$ref": "#/entities/Player" }
            },
            "gameState": { "type": "string", "enum": ["waiting", "SPINNING", "PLAYING", "EVALUATING", "RESULTS"] },
            "currentLetter": { "type": "string" },
            "roundNumber": { "type": "number" },
            "roundStartedAt": { "type": "string", "format": "date-time" },
            "playerResponses": { "type": "object" },
            "roundResults": { "type": "object" },
            "gameScores": { "type": "object" }
        },
        "required": ["hostId", "status", "createdAt", "settings", "players", "roundNumber", "gameState"]
    },
    "Ranking": {
        "title": "Ranking",
        "type": "object",
        "description": "Represents a player's entry in the global leaderboard.",
        "properties": {
            "playerName": { "type": "string" },
            "photoURL": { "type": "string", "format": "uri" },
            "totalScore": { "type": "number" },
            "gamesPlayed": { "type": "number" },
            "gamesWon": { "type": "number" },
            "averageScore": { "type": "number" },
            "bestScore": { "type": "number" },
            "lastPlayed": { "type": "string", "format": "date-time" },
            "level": { "type": "string" },
            "achievements": { "type": "array", "items": { "type": "string" } },
            "coins": { "type": "number" },
            "missionsLastReset": { "type": "string" }
        },
        "required": ["playerName", "totalScore", "gamesPlayed"]
    },
    "GameHistory": {
        "title": "GameHistory",
        "type": "object",
        "description": "Represents a single game result for a player's history.",
        "properties": {
            "playerId": { "type": "string" },
            "score": { "type": "number" },
            "letter": { "type": "string" },
            "gameMode": { "type": "string", "enum": ["solo", "private", "multiplayer"] },
            "won": { "type": "boolean" },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["playerId", "score", "letter", "gameMode", "won", "timestamp"]
    },
    "Notification": {
        "title": "Notification",
        "type": "object",
        "description": "Represents a notification sent to a user.",
        "properties": {
            "fromUserId": { "type": "string" },
            "fromUser": { "type": "string" },
            "recipientId": { "type": "string" },
            "roomId": { "type": "string" },
            "message": { "type": "string" },
            "type": { "type": "string", "enum": ["room_invite", "chat_mention"] },
            "status": { "type": "string", "enum": ["pending", "accepted", "declined"] },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["fromUserId", "recipientId", "type", "status", "timestamp"]
    }
  },
  "auth": {
    "providers": ["google.com", "facebook.com", "anonymous"]
  },
  "firestore": {
    "/rooms/{roomId}": {
        "schema": { "$ref": "#/entities/Room" },
        "description": "Stores multiplayer game rooms. Only authenticated users can read/write."
    },
     "/rooms/{roomId}/chat/{messageId}": {
        "schema": { "type": "object" },
        "description": "Subcollection for chat messages within a room."
    },
    "/rankings/{userId}": {
        "schema": { "$ref": "#/entities/Ranking" },
        "description": "Stores a player's global ranking and stats. Users can only update their own document."
    },
    "/rankings/{userId}/friends/{friendId}": {
        "schema": { "$ref": "#/entities/User" },
        "description": "Subcollection for a user's friends list."
    },
    "/rankings/{userId}/gameHistory/{gameId}": {
        "schema": { "$ref": "#/entities/GameHistory" },
        "description": "Subcollection for a player's game history."
    },
    "/notifications/{notificationId}": {
        "schema": { "$ref": "#/entities/Notification" },
        "description": "Stores notifications for users. Only the recipient can read/update their notifications."
    }
  }
}

    